<div class="loading-overlay" *ngIf="isLoading$ | async">
  <app-loading-dancing-squares [size]="22" [gap]="8"></app-loading-dancing-squares>
</div>
<div class="container mt-2">
  <div class="bar-buttons-top">
    <div class="title-f6">Lista de Órdenes de Pago</div>
  </div>
  <div class="bar-buttons-top d-flex w-100">
    <div class="input-group justify-content-start w-50">
      <span class="input-group-text"><i class="fa fa-search me-2"></i></span>
      <input (input)="filtrarOrdenPago()" type="text" class="form-control" placeholder="Filtrar Órdenes..."
        [(ngModel)]="filtrarOrden" />
    </div>
    <button (click)="onBack()" class="general-button btn-secondary">
      <i class="fas fa-arrow-left"></i>
      Regresar
    </button>
  </div>
  <div class="table-container table-responsive">
    <table class="table global-table table-striped table-hover">
      <thead>
        <th class="text-center">Nro de Orden</th>
        <th *ngIf="isAdminUser" class="text-center">Auxiliar</th>
        <th class="text-center">Fecha de Orden</th>
        <th class="text-center">Tipo de Gasto</th>
        <th class="text-center">Moneda</th>
        <th class="text-center">Importe</th>
        <th class="text-center">Estado</th>
        <th class="text-center">Acciones</th>
      </thead>
      <tbody>
        <tr *ngFor="let reg of pagedOrdenes">
          <td class="text-center">{{reg.numOrden}}</td>
          <td *ngIf="isAdminUser" class="text-start">{{reg.cdesAuxiliar}}</td>
          <td class="text-center">{{reg.fecOrden | date: 'yyyy-MM-dd'}}</td>
          <td class="text-start">{{reg.cdesTipoGasto}}</td>
          <td class="text-center">{{reg.cdesMoneda}}</td>
          <td class="text-end">{{reg.impOrdPago | number: '1.2-2'}}</td>
          <td class="text-center">{{reg.tipEstado}}</td>
          <td class="text-center">
            <button (click)="openEditOrdenPago(reg)" type="button" title="Rendir cuenta" type="button"
              class="btn btn-success btn-sm me-1"><i class="fa fa-plus"></i></button>
            <button style="background-color: #0063A7;" title="Ver Detalle" type="button"
              class="btn btn-primary btn-sm"><i class="fa fa-eye"></i></button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="card-footer bg-white border-0 py-3 d-flex justify-content-between align-items-center">
      <span class="text-muted small" style="font-family: var(--app-font-family) !important;">
        Mostrando Página <strong>{{ currentPage + 1 }}</strong> de
        <strong>{{ totalPages }}</strong> (Total: {{ totalItems }})
      </span>

      <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm mb-0">
          <li class="page-item" [class.disabled]="currentPage === 0">
            <button class="page-link" (click)="changePage(currentPage - 1)" aria-label="Previous">
              <span aria-hidden="true">&laquo; Anterior</span>
            </button>
          </li>

          <li class="page-item disabled">
            <span class="page-link border-0 text-dark fw-bold">{{
              currentPage + 1
              }}</span>
          </li>

          <li class="page-item" [class.disabled]="currentPage >= totalPages - 1">
            <button class="page-link" (click)="changePage(currentPage + 1)" aria-label="Next">
              <span aria-hidden="true">Siguente &raquo;</span>
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>