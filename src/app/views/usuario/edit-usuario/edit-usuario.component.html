<div class="loading-overlay" *ngIf="isLoading$ | async">
    <app-loading-dancing-squares [size]="22" [gap]="8"></app-loading-dancing-squares>
</div>
<div class="container mt-2">
    <div class="bar-buttons-top">
        <div class="title-f6">Nuevo Usuario</div>
    </div>
    <div class="bar-buttons-top d-flex justify-content-end w-100">
        <button (click)="onGuardarUsuario()" class="general-button btn-primary me-2">
            <i class="fas fa-save"></i>
            Guardar
        </button>
        <button (click)="onBack()" class="general-button btn-secondary">
            <i class="fas fa-arrow-left"></i>
            Regresar
        </button>
    </div>
</div>

<div class="row mb-2">
    <div class="col-md-3">
        <label class="form-label fw-semibold mb-2 d-block" for="auxiliarcodigo">Auxiliar</label>
        <div class="input-group">
            <input style="width: 80px !important;" required readonly type="text" class="form-control"
                name="auxiliarcodigo" id="auxiliarcodigo" [(ngModel)]="auxiliarSeleccionado.codAuxiliar" />
            <button (click)="openModalAuxiliar()" title="Buscar Auxiliar" class="input-group-text"><i
                    class="fas fa-search"></i></button>
        </div>
    </div>
    <div class="col-md-3">
        <label class="form-label fw-semibold mb-2 d-block" for="paterno">Apellido Paterno</label>
        <input class="form-control" id='paterno' name='paterno' type="text"
            [(ngModel)]="usuario.userLastName" />
    </div>
    <div class="col-md-3">
        <label class="form-label fw-semibold mb-2 d-block" for="materno">Apellido Materno</label>
        <input class="form-control" id='materno' name='materno' type="text"
            [(ngModel)]="usuario.userMiddleName" />
    </div>
    <div class="col-md-3">
        <label class="form-label fw-semibold mb-2 d-block" for="nombres">Nombres</label>
        <input class="form-control" id='nombres' name='nombres' type="text"
            [(ngModel)]="usuario.userName" />
    </div>
</div>
<div class="row">
    <div class="col-md-3">
        <label class="form-label fw-semibold mb-2 d-block" for="mail">E-Mail</label>
        <input readonly class="form-control" id='mail' name='mail' type="text" [(ngModel)]="usuario.userEmail" />
    </div>
    <div class="col-md-2">
        <label class="form-label fw-semibold mb-2 d-block" for="username">Username</label>
        <input readonly class="form-control" id='username' name='username' type="text" [(ngModel)]="usuario.userUsername" />
    </div>
    <div class="col-md-3">
        <label class="form-label fw-semibold mb-2 d-block" for="password">Perfil</label>
        <select name="perfil" id="perfil" class="form-select" [(ngModel)]="profileSeleccionado.profileId">
            <option *ngFor="let profile of profiles" [value]="profile.profileId">{{profile.profileLongName}}</option>
        </select>
    </div>
    <div class="col-md-2">
        <label class="form-label fw-semibold mb-2 d-block" for="password">Password Anterior</label>
        <input readonly class="form-control" id='nombres' name='password' type="password"
            [(ngModel)]="usuario.userOldPassword" />
    </div>
    <div class="col-md-2">
        <label class="form-label fw-semibold mb-2 d-block" for="password">Nuevo Password</label>
        <input readonly class="form-control" id='nombres' name='password' type="password"
            [(ngModel)]="usuario.userPassword" />
    </div>
</div>

<ng-template #auxiliarTemplate>
    <div class="modal-content-wrapper p-3">

        <!-- Header -->
        <div class="modal-header mb-2">
            <h5 class="modal-title">Lista Auxiliares</h5>
            <button class="btn-close" (click)="closeModalAuxiliar()"></button>
        </div>

        <!-- Filtro -->
        <div class="mb-2">
            <input type="text" class="form-control" placeholder="Filtrar auxiliar..." [(ngModel)]="filtroAuxiliar"
                (input)="filtrarAuxiliares()">
        </div>

        <!-- Body -->
        <div class="modal-body flex-grow-1" style="padding-right: 20px !important;">
            <table class="table table striped table-hover">
                <tbody>
                    <tr *ngFor="let auxiliar of listaAuxiliaresFiltrada; let i=index; ">
                        <td>{{auxiliar.desAuxiliar}}</td>
                        <td style="width:40px">
                            <button type="button" class="btn btn-sm btn-primary"
                                (click)="seleccionarAuxiliar(auxiliar)">
                                âœ”
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Footer -->
        <div class="modal-footer d-flex justify-content-between mt-3">
            <button class="general-button btn-danger" (click)="closeModalAuxiliar()">
                <i class="fas fa-times"></i> Cerrar
            </button>
        </div>

    </div>
</ng-template>